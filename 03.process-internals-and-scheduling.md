# Process Internals and Switching

## 1. Introduction to Processes

### 1.1. What is a process?

- A process is a running instance of a program.
- It’s the OS’s way of tracking and managing all active programs.
- Example:
  - The Firefox application file on disk → /usr/bin/firefox
  - When user opens it, OS loads it into memory → creates a process.
- That process has:
  - Its own memory area.
  - Unique ID (PID).
  - Registers, program counter, and stack.
  - Permissions and owner.
  - Parent process.

### 1.2. Program VS Process

| Program | Process |
| - | - |
| Static file stored on disk. | Running instance in memory. |
| Passive (does nothing until run) | Active (uses CPU, memory, etc.) |
| Example: `/usr/bin/vim` | Example: `PID 1472 running vim` |

## 2. Process Lifecycle

### 2.1. Process lifecycle overview

- A process goes through multiple stages:

```bash
+-----+       +-------+       +---------+       +------------+
| New | --->  | Ready | --->  | Running | --->  | Terminated |
+-----+       +-------+       +---------+       +------------+
                  ↑                ↓
                  |                |
            +---------+       +---------+
            | Waiting | <---- | Blocked |
            +---------+       +---------+
```

### 2.2. Process States explaination

| State | Meaning |
| - | - |
| **New** | Being created (not yet running) |
| **Ready** | Waiting for CPU time |
| **Running** | Currently executing on CPU |
| **Waiting/Blocked** | Waiting for I/O (e.g., reading from disk) |
| **Terminated/Zombie** | Finished but waiting for parent to acknowledge it |

### 2.3. Process hierarchy

- Every process is started by another process (except init or systemd, PID 1).
- `pstree` command is used to display the hierarchy of different processes.
- `systemd` is the root parent process.
- Every child inherits environment, permissions, and sometimes file descriptors from its parent.
